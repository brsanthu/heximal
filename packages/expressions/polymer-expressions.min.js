define("polymer-expressions/parser",["exports"],function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e,n){return{kind:t,value:e,precedence:n||0}}function r(t,e){return new d(t,e).parse()}t.__esModule=!0,t.token=n,t.parse=r;var i=["this"];t.PRECEDENCE=s;var s={"!":0,":":0,",":0,")":0,"]":0,"}":0,"?":1,"||":2,"&&":3,"|":4,"^":5,"&":6,"!=":7,"==":7,"!==":7,"===":7,">=":8,">":8,"<=":8,"<":8,"+":9,"-":9,"%":10,"/":10,"*":10,"(":11,"[":11,".":11,"{":11};t.POSTFIX_PRECEDENCE=11,t.STRING=1,t.IDENTIFIER=2,t.DOT=3,t.COMMA=4,t.COLON=5,t.INTEGER=6,t.DECIMAL=7,t.OPERATOR=8,t.GROUPER=9,t.KEYWORD=10;var a=11,u=2,o=3,h=4,c=6,_=7,p=8,f=9,v=10,l=function(){function t(t){return/^\s$/.test(t)}function r(t){return/^[a-zA-Z_$]$/.test(t)}function a(t){return/^[a-zA-Z0-9_$]$/.test(t)}function u(t){return-1!==i.indexOf(t)}function o(t){return/^[\"\']$/.test(t)}function h(t){return/^[0-9]$/.test(t)}function c(t){return-1!=="+-*/!&%<=>?^|".indexOf(t)}function _(t){return-1!=="()[]{}".indexOf(t)}function p(t){return t.replace(/\\(.)/g,function(t,e){switch(e){case"n":return"\n";case"r":return"\r";case"t":return"	";case"b":return"\b";case"f":return"\f";default:return e}})}return function(){function i(t){e(this,i),this._input=t,this._index=-1,this._tokenStart=0,this._next=null}return i.prototype._advance=function(t){this._index<this._input.length?(this._index++,this._next=this._input[this._index],t&&(this._tokenStart=this._index)):this._next=null},i.prototype._getValue=function(t){var e=this._input.substring(this._tokenStart,this._index+(t||0));return t||this._clearValue(),e},i.prototype._clearValue=function(){this._tokenStart=this._index},i.prototype.nextToken=function(){for(-1===this._index&&this._advance();t(this._next);)this._advance(!0);return o(this._next)?this._tokenizeString():r(this._next)?this._tokenizeIdentOrKeyword():h(this._next)?this._tokenizeNumber():"."===this._next?this._tokenizeDot():","===this._next?this._tokenizeComma():":"===this._next?this._tokenizeColon():c(this._next)?this._tokenizeOperator():_(this._next)?this._tokenizeGrouper():(this._advance(),console.assert(!this._next),null)},i.prototype._tokenizeString=function(){var t="unterminated string",e=this._next;for(this._advance(!0);this._next!==e;){if(!this._next)throw new Error(t);if("\\"===this._next&&(this._advance(),!this._next))throw new Error(t);this._advance()}var r=n(1,p(this._getValue()));return this._advance(),r},i.prototype._tokenizeIdentOrKeyword=function(){for(;a(this._next);)this._advance();var t=this._getValue(),e=u(t)?10:2;return n(e,t)},i.prototype._tokenizeNumber=function(){for(;h(this._next);)this._advance();return"."===this._next?this._tokenizeDot():n(6,this._getValue())},i.prototype._tokenizeDot=function(){return this._advance(),h(this._next)?this._tokenizeFraction():(this._clearValue(),n(3,".",11))},i.prototype._tokenizeComma=function(){return this._advance(!0),n(4,",")},i.prototype._tokenizeColon=function(){return this._advance(!0),n(5,":")},i.prototype._tokenizeFraction=function(){for(;h(this._next);)this._advance();return n(7,this._getValue())},i.prototype._tokenizeOperator=function(){this._advance();var t=this._getValue(2);return-1!==["===","!=="].indexOf(t)?(this._advance(),this._advance()):(t=this._getValue(1),-1!==["==","!=","<=",">=","||","&&"].indexOf(t)&&this._advance()),t=this._getValue(),n(8,t,s[t])},i.prototype._tokenizeGrouper=function(){var t=this._next,e=n(9,t,s[t]);return this._advance(!0),e},i}()}();t.Tokenizer=l;var d=function(){function t(n,r){e(this,t),this._tokenizer=new l(n),this._ast=r,this._token=null,this._kind=null,this._value=null}return t.prototype.parse=function(){return this._advance(),this._parseExpression()},t.prototype._advance=function(t,e){if(!this._matches(t,e))throw new Error("Expected kind "+t+" ("+e+"), was "+this._token);var n=this._tokenizer.nextToken();this._token=n,this._kind=n&&n.kind,this._value=n&&n.value},t.prototype._matches=function(t,e){return!(t&&this._kind!=t||e&&this._value!==e)},t.prototype._parseExpression=function(){if(!this._token)return this._ast.empty();var t=this._parseUnary();return t?this._parsePrecedence(t,0):null},t.prototype._parsePrecedence=function(t,e){for(console.assert(t);this._token;)if(this._matches(f,"(")){var n=this._parseArguments();t=this._ast.invoke(t,null,n)}else if(this._matches(f,"[")){var r=this._parseIndex();t=this._ast.index(t,r)}else if(this._matches(o)){this._advance();var i=this._parseUnary();t=this._makeInvokeOrGetter(t,i)}else{if(this._matches(v))break;if(!(this._matches(p)&&this._token.precedence>=e))break;t="?"==this._value?this._parseTernary(t):this._parseBinary(t)}return t},t.prototype._makeInvokeOrGetter=function(t,e){if("ID"===e.type)return this._ast.getter(t,e.value);if("Invoke"===e.type&&"ID"===e.receiver.type){var n=e.receiver;return this._ast.invoke(t,n.value,e.arguments)}throw new Error("expected identifier: "+e)},t.prototype._parseBinary=function(t){var e=this._token;if(-1===["+","-","*","/","%","^","==","!=",">","<",">=","<=","||","&&","&","===","!==","|"].indexOf(e.value))throw new Error("unknown operator: "+e.value);this._advance();for(var n=this._parseUnary();(8==this._kind||3==this._kind||9==this._kind)&&this._token.precedence>e.precedence;)n=this._parsePrecedence(n,this._token.precedence);return this._ast.binary(t,e.value,n)},t.prototype._parseUnary=function(){if(this._matches(p)){var t=this._value;if(this._advance(),"+"===t||"-"===t){if(this._matches(c))return this._parseInteger(t);if(this._matches(_))return this._parseDecimal(t)}if(-1===["+","-","!"].indexOf(t))throw new Error("unexpected token: "+t);var e=this._parsePrecedence(this._parsePrimary(),a);return this._ast.unary(t,e)}return this._parsePrimary()},t.prototype._parseTernary=function(t){this._advance(8,"?");var e=this._parseExpression();this._advance(5);var n=this._parseExpression();return this._ast.ternary(t,e,n)},t.prototype._parsePrimary=function(){switch(this._kind){case 10:var t=this._value;if("this"===t)return this._advance(),this._ast.id(t);if(-1!==i.indexOf(t))throw new Error("unexpected keyword: "+t);throw new Error("unrecognized keyword: "+t);case 2:return this._parseInvokeOrIdentifier();case 1:return this._parseString();case 6:return this._parseInteger();case 7:return this._parseDecimal();case 9:return"("==this._value?this._parseParen():"{"==this._value?this._parseMap():"["==this._value?this._parseList():null;case 5:throw new Error('unexpected token ":"');default:return null}},t.prototype._parseList=function(){var t=[];do{if(this._advance(),this._matches(f,"]"))break;t.push(this._parseExpression())}while(this._matches(4));return this._advance(9,"]"),this._ast.list(t)},t.prototype._parseMap=function(){var t={};do{if(this._advance(),this._matches(f,"}"))break;var e=this._value;this._advance(1),this._advance(5),t[e]=this._parseExpression()}while(this._matches(4));return this._advance(9,"}"),this._ast.map(t)},t.prototype._parseInvokeOrIdentifier=function(){var t=this._value;if("true"===t)return this._advance(),this._ast.literal(!0);if("false"===t)return this._advance(),this._ast.literal(!1);if("null"==t)return this._advance(),this._ast.literal(null);var e=this._parseIdentifier(),n=this._parseArguments();return n?this._ast.invoke(e,null,n):e},t.prototype._parseIdentifier=function(){if(!this._matches(u))throw new Error("expected identifier: "+this._value);var t=this._value;return this._advance(),this._ast.id(t)},t.prototype._parseArguments=function(){if(this._matches(f,"(")){var t=[];do{if(this._advance(),this._matches(f,")"))break;var e=this._parseExpression();t.push(e)}while(this._matches(h));return this._advance(f,")"),t}return null},t.prototype._parseIndex=function(){if(this._matches(f,"[")){this._advance();var t=this._parseExpression();return this._advance(f,"]"),t}return null},t.prototype._parseParen=function(){this._advance();var t=this._parseExpression();return this._advance(9,")"),this._ast.paren(t)},t.prototype._parseString=function(){var t=this._ast.literal(this._value);return this._advance(),t},t.prototype._parseInteger=function(t){t=t||"";var e=this._ast.literal(parseInt(""+t+this._value,10));return this._advance(),e},t.prototype._parseDecimal=function(t){t=t||"";var e=this._ast.literal(parseFloat(""+t+this._value));return this._advance(),e},t}();t.Parser=d}),define("polymer-expressions/eval",["exports"],function(t){"use strict";function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var n=function(){function t(){e(this,t)}return t.prototype.empty=function(){return{evaluate:function(t){return t},getIds:function(t){return t}}},t.prototype.literal=function(t){return{type:"Literal",value:t,evaluate:function(t){return this.value},getIds:function(t){return t}}},t.prototype.id=function(t){return{type:"ID",value:t,evaluate:function(t){return"this"===this.value?t:t[this.value]},getIds:function(t){return t.push(this.value),t}}},t.prototype.unary=function(t,e){var n={"+":function(t){return t},"-":function(t){return-t},"!":function(t){return!t}}[t];return{type:"Unary",operator:t,child:e,evaluate:function(t){return n(this.child.evaluate(t))},getIds:function(t){return this.child.getIds(t)}}},t.prototype.binary=function(t,e,n){var r={"+":function(t,e){return t+e},"-":function(t,e){return t-e},"*":function(t,e){return t*e},"/":function(t,e){return t/e},"%":function(t,e){return t%e},"==":function(t,e){return t==e},"!=":function(t,e){return t!=e},"===":function(t,e){return t===e},"!==":function(t,e){return t!==e},">":function(t,e){return t>e},">=":function(t,e){return t>=e},"<":function(t,e){return e>t},"<=":function(t,e){return e>=t},"||":function(t,e){return t||e},"&&":function(t,e){return t&&e},"|":function(t,e){return e(t)}}[e];return{type:"Binary",operator:e,left:t,right:n,evaluate:function(t){return r(this.left.evaluate(t),this.right.evaluate(t))},getIds:function(t){return this.left.getIds(t),this.right.getIds(t),t}}},t.prototype.getter=function(t,e){return{type:"Getter",receiver:t,name:e,evaluate:function(t){return this.receiver.evaluate(t)[this.name]},getIds:function(t){return this.receiver.getIds(t),t}}},t.prototype.invoke=function(t,e,n){return{type:"Invoke",receiver:t,method:e,arguments:n,evaluate:function(t){var e=this.receiver.evaluate(t),n=this.arguments.map(function(e){return e.evaluate(t)}),r=null==this.method?e:e[this.method];return r.apply(e,n)},getIds:function(t){return this.receiver.getIds(t),this.arguments.forEach(function(e){return e.getIds(t)}),t}}},t.prototype.parenthesized=function(t){return t},t.prototype.index=function(t,e){return{type:"Index",receiver:t,argument:e,evaluate:function(t){return this.receiver.evaluate(t)[this.argument.evaluate(t)]},getIds:function(t){return this.receiver.getIds(t),t}}},t.prototype.ternary=function(t,e,n){return{type:"Ternary",condition:t,trueExpr:e,falseExpr:n,evaluate:function(t){var e=this.condition.evaluate(t);return e?this.trueExpr.evaluate(t):this.falseExpr.evaluate(t)},getIds:function(t){return this.condition.getIds(t),this.trueExpr.getIds(t),this.falseExpr.getIds(t),t}}},t.prototype.map=function(t){return{type:"Map",entries:t,evaluate:function(e){var n={};for(var r in t)n[r]=this.entries[r].evaluate(e);return n},getIds:function(e){for(var n in t)this.entries[n].getIds(e);return e}}},t.prototype.list=function(t){return{type:"List",items:t,evaluate:function(t){return this.items.map(function(e){return e.evaluate(t)})},getIds:function(t){return this.items.forEach(function(e){e.getIds(t)}),t}}},t}();t.EvalAstFactory=n});