define("stampino",["require","exports","incremental-dom","polymer-expressions/parser","polymer-expressions/eval"],function(e,t,r,n,a){"use strict";function o(e,t){if(e.startsWith("{{")&&e.endsWith("}}")){var r=e.substring(2,e.length-2),a=new n.Parser(r,c).parse();return a.evaluate(t)}return e.startsWith("\\{{")?e.substring(1):e}function i(e){for(var t=e.content.querySelectorAll("template[name]"),r={},n=function(e){var n=t[e],a=n.getAttribute("name");"super"!==a&&(r[a]=function(e,t,r,a){return l(n.content,e,t,r,a)})},a=0;a<t.length;a++)n(a);return r}function u(e,t,r,n,a){if(r=r||p,t=t||{},a){var o=e.content.querySelector("[name=super]");if(o){var u=i(o);t={"super":function(e,t,r,n){l(a.content,e,u,r,n)}}}else{var s=i(e);Object.assign(s,t),t=s,e=a}}return function(a){return l(e.content,a,t,r,n)}}function s(e,t,n,a){var o=u(e,a.renderers,a.handlers,a.attributeHandler,a["extends"]);r.patch(t,o,n)}function l(e,t,n,a,i){switch(e.nodeType){case Node.DOCUMENT_FRAGMENT_NODE:for(var u=e.childNodes,s=0;s<u.length;s++)l(u[s],t,n,a,i);break;case Node.ELEMENT_NODE:var c=e;if("template"===c.tagName.toLowerCase()){var f=c,p=c.getAttribute("type");if(p){var v=a[p];if(!v)return void console.warn("No handler for template type",p);v(f,t,n,a,i)}var d=c.getAttribute("name");if(d){if(n){var h=n[d];if(h)return void h(t,n,a,i)}return void l(f.content,t,n,a,i)}}else{for(var m=[c.tagName,null,null],g=c.attributes,b=[],s=0;s<g.length;s++){var N=g[s];i&&i.matches(N.name)?b.push(N):(m.push(N.name),m.push(o(N.value,t)))}for(var y=r.elementOpen.apply(null,m),s=0;s<b.length;s++){var N=b[s];i.handle(y,N.name,N.value,t)}for(var E=e.childNodes,s=0;s<E.length;s++)l(E[s],t,n,a,i);r.elementClose(c.tagName)}break;case Node.TEXT_NODE:var A=o(e.nodeValue,t);r.text(A);break;default:console.warn("unhandled node type",e.nodeType)}}var c=new a.EvalAstFactory,f=function(e){return e.replace(/-(\w)/,function(e,t){return t.toUppercase()})};r.attributes.__default=function(e,t,r){t.endsWith("$")?(t=t.substring(0,t.length-1),e.setAttribute(t,r)):e[f(t)]=r},t.getValue=o;var p={"if":function(e,t,r,n,a){var i=e.getAttribute("if");i&&o(i,t)&&l(e.content,t,r,n,a)},repeat:function(e,t,r,n,a){var i=e.getAttribute("repeat");if(i)for(var u=o(i,t),s=0;s<u.length;s++){var c=u[s],f=Object.create(t);f.item=c,f.index=s,f["this"]=t["this"]||t,l(e.content,f,r,n,a)}}};t.prepareTemplate=u,t.render=s,t.renderNode=l});